{extend name="Public:base" /}
{block name="content"}
<div class="layui-fluid">
    <div class="layui-card">
        <div class="layui-card-header">{$title}</div>
        <div class="layui-card-body">
            <div class="layui-form" >
                <div class="layui-input-inline">
                    <input type="text" name="title" id="title" placeholder="请输入标题" class="layui-input">
                </div>
                <a class="layui-btn search_btn" data-type="reload" id="searchBtn">搜索</a>
            </div>
        </div>
        <div class="layui-card-body">
            <table id="dataTable" lay-filter="dataTable"></table>
            <script type="text/html" id="position">
                @{{ d.position.name }}
            </script>
            <script type="text/html" id="thumb">
                <a href="@{{d.thumb}}" target="_blank" title="点击查看"><img src="@{{d.thumb}}" alt="" width="28" height="28"></a>
            </script>
        </div>
    </div>
</div>
{/block}


{block name="script"}
<script>
    layui.use(['layer','table','form','jquery'],function () {
        var $ = layui.$;
        var layer = layui.layer;
        var form = layui.form;
        var table = layui.table;
        //用户表格初始化
        var dataTable = table.render({
            elem: '#dataTable'
            ,height: $(window).height() - 150
            ,url: "{:url('@home/download/data')}" //数据接口
            ,page: true //开启分页
            ,cols: [[ //表头
                {checkbox: true,fixed: true}
                ,{field: 'id', title: 'ID', sort: true,width:80}
                ,{field: 'title', title: '标题'}
                ,{field: 'name', title: '文章名称',templet: '<div><a href="{{d.url}}" class="layui-table-link">{{d.name}}</a></div>'}
            ]]
            , limit: 18
            , id: 'testReload'
        });
        var $ = layui.$, active = {
            reload: function () {
                //执行重载
                table.reload('testReload', {
                    page: {
                        curr: 1 //重新从第 1 页开始
                    }
                    , where: {
                        title: $('#title').val(),
                    }
                });
            }
        };
        //搜索
        $('#searchBtn').on('click', function () {
            var type = $(this).data('type');
            active[type] ? active[type].call(this) : '';
        });
    })
</script>
{/block}